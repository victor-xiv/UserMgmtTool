/*
 * Copyright (c) Orchestral Developments Ltd (2001 - 2008).
 *
 * This document is copyright. Except for the purpose of fair reviewing, no part
 * of this publication may be reproduced or transmitted in any form or by any
 * means, electronic or mechanical, including photocopying, recording, or any
 * information storage and retrieval system, without permission in writing from
 * the publisher. Infringers of copyright render themselves liable for
 * prosecution.
 */
var MINIMUM_HEIGHT=50;var SCROLL_INTERVAL=25;var SCROLL_SPACING=5;var logoutAttempts;var logoutTimeout;var openMenu=null;var scrollTimer;function init(B){if(MESSAGING_ENABLED){newMessages();setInterval(newMessages,120000)}try{toggleMenu(B)}catch(A){}document.getElementById("ConcertoLogo").title=top.CONCERTO_LOGO_TITLE;top.updateCcowLinks();top.resetInactivityTimeout()}function destroy(){if(postLoginWindow!=null){postLoginWindow.close()}if(logoutWindow!=null){logoutWindow.close()}if(customLogoutWindow!=null){customLogoutWindow.close()}}function newMessages(){AsyncConnector.serviceRequest(new HttpGetRequest("NewMessages.action"),newMessagesCallback)}function newMessagesCallback(response){var info;try{var content=response.getContent();info=eval(content)}catch(e){return }var className="Read";if(info.unreadMessageCount>0){className=info.hasNewImportantUnreadMessages?"UnreadImportant":"Unread"}document.getElementById("MessagesButton").className=className;var elmUnreadMessageCount=document.getElementById("UnreadMessageCount");while(elmUnreadMessageCount.firstChild){elmUnreadMessageCount.removeChild(elmUnreadMessageCount.firstChild)}if(info.unreadMessageCount>0){var elmUnreadCountText=document.createTextNode(info.unreadMessageCount);elmUnreadMessageCount.appendChild(elmUnreadCountText)}if(info.hasNewImportantUnreadMessages){top.WebMain.Event.importantMessageReceived.fire()}resize()}function resetLogoutButtonText(){updateLogoutButtonText(LOGOUT_TEXT)}function updateLogoutButtonText(A){document.getElementById("LogoutButton").innerHTML=A}function home(){top.ConcertoContext.location.href="Context.htm?operation=clearContext"}function openApplication(C,B){var A=new Url("Context.htm");A.addQueryParameter("operation","clearContext");A.addQueryParameter("applicationName",C);A.addQueryParameter("entryPointName",B);top.ConcertoContext.location.href=A.toString()}function openApplicationInWindow(E,D,A,C,B){concerto.openApplicationInWindow(new Application(E,D),null,null,A,C,B)}function openApplicationInModelessDialog(E,D,A,C,B){concerto.openApplicationInModelessDialog(new Application(E,D),A,C,null,null,B)}function openLogoutDialog(){var A=190;logoutWindow=new Window("LogoutDialog.htm",function(B){top.ConcertoContext.location.href="/concerto/Blank.htm";logoutAttempts=0;clearTimeout(logoutTimeout);continueLogout(B)},350,A,"logoutWindow");logoutWindow.open()}function continueLogout(action){if(logoutAttempts++>50){clearTimeout(logoutTimeout);return }try{eval(action);return }catch(e){alert(e)}logoutTimeout=setTimeout('continueLogout("'+action+'")',50)}function logoutOverride(){top.ConcertoContext.location.href="Logout.htm"}function toggleMenu(A){var B=document.getElementById("Menu"+A);currentWindow=A;if(openMenu!=null){YAHOO.util.Dom.getPreviousSibling(openMenu).className="MenuName";openMenu.style.display="none"}if(openMenu!=null&&B.id==openMenu.id){openMenu=null}else{YAHOO.util.Dom.getPreviousSibling(B).className="MenuName Selected";B.style.display="block";openMenu=B}setTimeout(resize,0)}function resize(){var B=document.getElementById("Bottom");var C=document.getElementById("Menus");if(openMenu!=null){var D=openMenu.scrollTop;openMenu.style.overflow="visible";openMenu.style.height=YAHOO.util.Dom.getY(YAHOO.util.Dom.getLastChild(openMenu))-YAHOO.util.Dom.getY(openMenu);var E=C.offsetHeight+B.offsetHeight-YAHOO.util.Dom.getViewportHeight();if(E>0){openMenu.style.overflow="hidden";var A=openMenu.offsetHeight-E;openMenu.style.height=(A<MINIMUM_HEIGHT)?MINIMUM_HEIGHT:A;openMenu.scrollTop=D}}updateButtons();B.style.visibility=B.offsetTop<C.offsetHeight-1?"hidden":"visible"}function updateButtons(){var A=document.getElementById("Up");var B=document.getElementById("Down");if(openMenu!=null&&openMenu.scrollTop>0){A.style.display="block";A.style.top=YAHOO.util.Dom.getY(YAHOO.util.Dom.getPreviousSibling(openMenu))+25}else{A.style.display="none"}if(openMenu!=null&&YAHOO.util.Dom.getY(YAHOO.util.Dom.getLastChild(openMenu))>YAHOO.util.Dom.getY(YAHOO.util.Dom.getNextSibling(openMenu))){B.style.display="block";B.style.top=YAHOO.util.Dom.getY(YAHOO.util.Dom.getNextSibling(openMenu))-25}else{B.style.display="none"}}function startScrollingUp(){scrollTimer=setInterval(scrollUp,SCROLL_INTERVAL)}function startScrollingDown(){scrollTimer=setInterval(scrollDown,SCROLL_INTERVAL)}function stopScrolling(){clearInterval(scrollTimer)}function scrollUp(){openMenu.scrollTop-=SCROLL_SPACING;updateButtons();if(openMenu.scrollTop==0){stopScrolling()}}function scrollDown(){openMenu.scrollTop+=SCROLL_SPACING;updateButtons();if(openMenu.scrollTop>openMenu.scrollHeight-openMenu.offsetHeight){stopScrolling()}}function scrollToTop(){YAHOO.util.Dom.getFirstChild(openMenu).scrollIntoView(true);updateButtons();stopScrolling()}function scrollToBottom(){YAHOO.util.Dom.getLastChild(openMenu).scrollIntoView();updateButtons();stopScrolling()}function sizeLogo(){var A=document.getElementById("SiteLogo");if(A.width>document.body.clientWidth){A.width=document.body.clientWidth}}function updateForOverride(A){document.getElementById("User").innerHTML=A.length<=11?A:A.substring(0,8)+"...";document.getElementById("LogoutButton").className+=" LogoutOverride"}function openLogin(){top.location.replace("Login.htm")};